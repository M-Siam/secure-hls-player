<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secure HLS Player</title>
  <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
</head>
<body>
  <video-js
    id="my-player"
    class="vjs-default-skin"
    controls
    preload="auto"
    width="100%"
    height="auto"
    data-setup='{"fluid": true}'>
    <source src="http://localhost:3000/secure-stream?token=your-secret-token-123" type="application/x-mpegURL">
    <p class="vjs-no-js">Enable JavaScript for video playback.</p>
  </video-js>

  <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@videojs/http-streaming@3.4.1/dist/videojs-http-streaming.min.js"></script>
  <script>
    const player = videojs('my-player', {
      html5: {
        hls: {
          overrideNative: true,  // Use HLS.js for all browsers
          enableLowInitialPlaylist: true,  // Quick start
          smoothQualityChange: true  // No buffering on quality switch
        }
      },
      playbackRates: [0.5, 1, 1.25, 1.5, 2],  // Speed controls
      controlBar: {
        volumePanel: { inline: false },  // Volume slider
        pictureInPictureToggle: true,
        fullscreenToggle: true
      }
    });

    // Basic error handling
    player.ready(() => {
      console.log('Player ready!');
      player.on('error', () => {
        const err = player.error();
        if (err && err.code === 4) {
          player.error({ code: 4, message: 'Stream failed. Check token or connection.' });
        }
      });
    });

    // Auto-play test (remove in production for user consent)
    player.play();
  </script>
</body>
</html>
